# cbindgen configuration for generating C/Swift headers
# Run: cbindgen --config cbindgen.toml --output include/oref.h

language = "C"

# Header file metadata
header = """
/*
 * oref - OpenAPS Reference Implementation in Rust
 *
 * This file is auto-generated by cbindgen. Do not edit manually.
 *
 * For iOS/Swift integration with Trio:
 * 1. Include this header in your bridging header
 * 2. Link against the liboref.a static library
 * 3. Use the oref_* functions to call the algorithms
 *
 * Memory Management:
 * All string pointers returned by oref functions must be freed using
 * oref_free_string() to prevent memory leaks.
 */
"""

include_guard = "OREF_H"
include_version = true
cpp_compat = true

# Naming conventions
[export]
prefix = "Oref"

# Only export FFI functions
[export.rename]
"oref_free_string" = "oref_free_string"
"oref_version" = "oref_version"
"oref_health_check" = "oref_health_check"
"oref_calculate_iob" = "oref_calculate_iob"
"oref_calculate_iob_current" = "oref_calculate_iob_current"
"oref_calculate_cob" = "oref_calculate_cob"
"oref_calculate_autosens" = "oref_calculate_autosens"
"oref_determine_basal" = "oref_determine_basal"
"oref_determine_basal_simple" = "oref_determine_basal_simple"
"oref_calculate_glucose_status" = "oref_calculate_glucose_status"

[fn]
# Prefix for function names (none, keep oref_ prefix)
prefix = ""

[parse]
# Parse these modules for FFI exports
parse_deps = false
# Don't expand macros (requires nightly)
expand = { crates = [] }

[defines]
# Feature flags for conditional compilation
"feature = ffi" = "OREF_FFI"
